¡Perfecto! Vamos a **comentar y explicar todos los scripts** siguiendo la estructura del borrador, para que quede **claro qué hace cada parte**, incluyendo la aclaración de los **modales en landing vs admin**. Mantendré la estructura minimalista que te sirve de “chuleta”.

---

# 1️⃣ login.js

```js
const BASE_URL = "http://localhost:3000"; // URL de nuestro servidor JSON falso
const form = document.getElementById("loginForm");

form.addEventListener("submit", async e => {
  e.preventDefault(); // evita que la página se recargue al enviar el formulario

  // Obtenemos los valores de los inputs
  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  // Consultamos la API simulada buscando coincidencia
  const res = await fetch(`${BASE_URL}/users?email=${email}&password=${password}`);
  const users = await res.json();

  const user = users[0]; // si existe, es el usuario que hizo login

  if (!user) {
    alert("Usuario o contraseña incorrectos"); // validación simple
    return;
  }

  // Guardamos sesión en localStorage
  localStorage.setItem("isAuth", "true"); // flag de sesión
  localStorage.setItem("role", user.role); // rol (admin/user)
  localStorage.setItem("currentUser", user.email); // email del usuario

  // Redirige según rol
  window.location.href = user.role === "admin" ? "admin.html" : "landing.html";
});
```

**Explicación:**

* Evita recarga del formulario (`e.preventDefault()`)
* Busca el usuario en la API
* Guarda sesión en `localStorage`
* Redirige según rol

---

# 2️⃣ landing.js

```js
const BASE_URL = "http://localhost:3000";
const container = document.getElementById("cards");

// Validar sesión: si no hay sesión o el rol no es user, redirige al login
if (!localStorage.getItem("isAuth") || localStorage.getItem("role") !== "user") {
  window.location.href = "login.html";
}

// Función para obtener todas las cartas de comida
async function getFoods() {
  const res = await fetch(`${BASE_URL}/foods`);
  return res.json();
}

// Función para renderizar las cartas en la landing
async function renderFoods() {
  const foods = await getFoods();
  container.innerHTML = ""; // limpia antes de renderizar
  foods.forEach(food => {
    container.innerHTML += `
      <div class="col-4">
        <div class="card">
          <img src="${food.image}" class="card-img-top">
          <div class="card-body">
            <h5>${food.name}</h5>
            <p>$${food.price}</p>
            <button class="btn btn-primary" onclick="openModal(${food.id})">Ver</button>
          </div>
        </div>
      </div>
    `;
  });
}

// FUNCION DEL MODAL
// Se llama cuando el usuario hace click en "Ver" de una carta
// Muestra la info dentro del modal de bootstrap
window.openModal = async id => {
  const foods = await getFoods(); // traemos todas las cartas
  const food = foods.find(f => f.id === id); // buscamos la carta clickeada
  document.getElementById("modalImg").src = food.image; // ponemos imagen
  document.getElementById("modalName").innerText = food.name; // nombre
  document.getElementById("modalDesc").innerText = food.description; // descripción
  document.getElementById("modalPrice").innerText = `$${food.price}`; // precio
  new bootstrap.Modal(document.getElementById("foodModal")).show(); // abrimos el modal
};

renderFoods(); // inicializa el render de todas las cartas
```

**Notas importantes:**

* Aquí el modal es **solo para ver la carta**, no para editar
* Se usa `window.openModal` porque se llama desde HTML inline (`onclick`)
* Cada vez que se abre el modal, se rellenan sus campos con la carta correspondiente

> ⚠️ En admin, si quieres **crear o editar cartas**, podemos usar otro modal con **form inputs**, distinto de este.

---

# 3️⃣ admin.js

```js
const BASE_URL = "http://localhost:3000";

// Validar sesión: solo admin puede entrar
if (!localStorage.getItem("isAuth") || localStorage.getItem("role") !== "admin") {
  window.location.href = "login.html";
}

// Obtenemos referencia al tbody de la tabla donde mostraremos las cartas
const tbody = document.querySelector("#foodTable tbody");

// FUNCION GET para traer todas las cartas
async function getFoods() {
  const res = await fetch(`${BASE_URL}/foods`);
  return res.json();
}

// Renderiza todas las cartas en la tabla del dashboard
async function renderTable() {
  const foods = await getFoods();
  tbody.innerHTML = ""; // limpia la tabla
  foods.forEach(food => {
    tbody.innerHTML += `
      <tr>
        <td>${food.name}</td>
        <td>${food.description}</td>
        <td>$${food.price}</td>
        <td><img src="${food.image}" width="50"/></td>
        <td>
          <button class="btn btn-warning btn-sm" onclick="editFood(${food.id})">Editar</button>
          <button class="btn btn-danger btn-sm" onclick="deleteFood(${food.id})">Eliminar</button>
        </td>
      </tr>
    `;
  });
}

// FUNCION POST para agregar una carta nueva desde inputs
window.addFood = async () => {
  const food = {
    name: document.getElementById("name").value,
    description: document.getElementById("description").value,
    price: Number(document.getElementById("price").value),
    image: document.getElementById("image").value
  };
  await fetch(`${BASE_URL}/foods`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(food)
  });
  renderTable(); // actualizar la tabla
};

// FUNCION DELETE para eliminar una carta
window.deleteFood = async id => {
  await fetch(`${BASE_URL}/foods/${id}`, { method: "DELETE" });
  renderTable(); // actualizar la tabla
};

// FUNCION PATCH para editar solo ciertos campos (aquí el precio)
window.editFood = async id => {
  const newPrice = prompt("Nuevo precio:");
  if (!newPrice) return; // cancelar
  await fetch(`${BASE_URL}/foods/${id}`, {
    method: "PATCH",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ price: Number(newPrice) })
  });
  renderTable(); // actualizar tabla
};

renderTable(); // inicializa la tabla al cargar
```

**Notas importantes:**

* Aquí podemos agregar un **modal separado** si queremos que la creación/edición se haga con formulario emergente en lugar de inputs arriba del dashboard.
* `editFood` usa `prompt` solo por simplicidad, en una versión con modal podemos rellenar los campos dentro del modal y luego enviar PATCH.
* Toda la tabla se **actualiza después de cada acción** (`renderTable()`).

---

# ✅ Conclusión de los scripts

1. **login.js:** valida el usuario y guarda sesión en localStorage
2. **landing.js:** muestra cartas, modal solo para ver detalles, sesión de user
3. **admin.js:** muestra dashboard con tabla, CRUD completo, sesión de admin
4. **window.openModal** en landing es **solo para mostrar info**
5. **En admin**, puedes usar un **modal distinto para crear/editar** para mantener consistencia con la UI de bootstrap

---

Si quieres, puedo hacer la **versión final de admin con modal bootstrap real** para crear y editar cartas, igual que la landing, en lugar de usar los inputs arriba y `prompt` para editar. Esto deja todo uniforme y más profesional.

¿Quieres que haga eso?
