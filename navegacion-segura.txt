Perfecto ğŸ”¥
Te voy a **simular un flujo REAL**, con **estructura mÃ­nima**, **roles**, **validaciones por pÃ¡gina** y **cÃ³digo justo y necesario** para que:

* el login decida a dÃ³nde ir
* la sesiÃ³n se mantenga
* no puedas navegar sin permiso
* no puedas â€œcolarteâ€ cambiando la URL

ğŸ‘‰ Todo **solo frontend**, bien pensado y ordenado.

---

# ğŸ§© ESTRUCTURA DEL PROYECTO

```
/project
â”‚
â”œâ”€â”€ login.html
â”œâ”€â”€ home.html        (usuario normal)
â”œâ”€â”€ admin.html       (administrador)
â”‚
â”œâ”€â”€ login.js
â”œâ”€â”€ guard.js
â”œâ”€â”€ logout.js
```

---

# 1ï¸âƒ£ LOGIN â€” ValidaciÃ³n y creaciÃ³n de sesiÃ³n

## ğŸ§  Regla

* Si email/password coinciden â†’ guardo sesiÃ³n
* SegÃºn rol â†’ redirijo

---

### ğŸ“„ `login.html`

```html
<form id="loginForm">
  <input type="email" id="email" required />
  <input type="password" id="password" required />
  <button type="submit">Login</button>
</form>

<script src="login.js"></script>
```

---

### ğŸ“„ `login.js`

```js
const form = document.getElementById("loginForm");

// usuarios simulados
const users = [
  { email: "user@mail.com", password: "123", role: "user" },
  { email: "admin@mail.com", password: "123", role: "admin" }
];

// si ya estÃ¡ logueado, no puede ver login
const isAuth = localStorage.getItem("isAuth");
const role = localStorage.getItem("role");

if (isAuth) {
  window.location.href = role === "admin" ? "admin.html" : "home.html";
}

form.addEventListener("submit", e => {
  e.preventDefault();

  const email = document.getElementById("email").value;
  const password = document.getElementById("password").value;

  const user = users.find(
    u => u.email === email && u.password === password
  );

  if (!user) {
    alert("Credenciales incorrectas");
    return;
  }

  // crear sesiÃ³n
  localStorage.setItem("isAuth", "true");
  localStorage.setItem("role", user.role);
  localStorage.setItem("currentUser", user.email);

  // redirecciÃ³n por rol
  window.location.href =
    user.role === "admin" ? "admin.html" : "home.html";
});
```

---

# 2ï¸âƒ£ GUARD â€” ProtecciÃ³n de pÃ¡ginas

ğŸ‘‰ **Este archivo es la clave de todo**

---

### ğŸ“„ `guard.js`

```js
const isAuth = localStorage.getItem("isAuth");
const role = localStorage.getItem("role");

// cada pÃ¡gina define quÃ© rol necesita
if (!isAuth) {
  window.location.href = "login.html";
}

if (typeof REQUIRED_ROLE !== "undefined" && role !== REQUIRED_ROLE) {
  window.location.href = "login.html";
}
```

---

# 3ï¸âƒ£ HOME â€” Usuario normal

## ğŸ§  Reglas

* Solo entra si estÃ¡ autenticado
* NO puede ser admin

---

### ğŸ“„ `home.html`

```html
<h1>Home Usuario</h1>
<button onclick="logout()">Logout</button>

<script>
  const REQUIRED_ROLE = "user";
</script>
<script src="guard.js"></script>
<script src="logout.js"></script>
```

---

# 4ï¸âƒ£ ADMIN â€” Administrador

## ğŸ§  Reglas

* Solo entra si estÃ¡ autenticado
* Rol obligatorio: admin

---

### ğŸ“„ `admin.html`

```html
<h1>Panel Admin</h1>
<button onclick="logout()">Logout</button>

<script>
  const REQUIRED_ROLE = "admin";
</script>
<script src="guard.js"></script>
<script src="logout.js"></script>
```

---

# 5ï¸âƒ£ LOGOUT â€” Cerrar sesiÃ³n correctamente

---

### ğŸ“„ `logout.js`

```js
function logout() {
  localStorage.clear();
  window.location.href = "login.html";
}
```

---

# 6ï¸âƒ£ FLUJO REAL COMPLETO (mental)

```
LOGIN
  â†“
ValidaciÃ³n de credenciales
  â†“
Guardar sesiÃ³n en localStorage
  â†“
RedirecciÃ³n segÃºn rol
  â†“
PÃ¡gina protegida valida permisos
  â†“
Usuario navega
  â†“
Logout â†’ borrar localStorage
  â†“
Vuelve al login
```

---

# 7ï¸âƒ£ PRUEBAS DE SEGURIDAD (importantes)

### âŒ Intentar ir a admin sin login

â¡ï¸ rebote al login

### âŒ Usuario normal escribe /admin.html

â¡ï¸ rebote al login

### âŒ Admin escribe /home.html

â¡ï¸ rebote al login

### âŒ Login estando autenticado

â¡ï¸ redirecciÃ³n automÃ¡tica

---

# 8ï¸âƒ£ QuÃ© aprendiste realmente aquÃ­ ğŸ¯

* `localStorage` = estado global del proyecto
* Solo existe **una sesiÃ³n activa**
* La seguridad estÃ¡ en:

  * validar **al cargar cada pÃ¡gina**
  * no en bloquear URLs
* El rol define **a dÃ³nde puedes entrar**
* El logout **siempre limpia todo**

---

Si quieres, el siguiente nivel puede ser:

* refactorizar esto en **un solo auth.js**
* agregar expiraciÃ³n de sesiÃ³n
* simular JWT
* o migrar esta lÃ³gica a backend real

Pero **este flujo estÃ¡ correcto, limpio y bien diseÃ±ado** ğŸ‘Œ
